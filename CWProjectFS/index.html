<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="images/CWLogo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script
      src="https://kit.fontawesome.com/2a50566d3f.js"
      crossorigin="anonymous"
    ></script>
    <title>After School Activities</title>
  </head>
  <body>
    <div id="app">
      <header
        class="flex items-center p-4 justify-between mx-auto fixed top-0 w-full bg-white z-10 shadow-md"
      >
        <div class="logo flex gap-2 items-center">
          <span class="min-w-fit">After School Activities</span>
        </div>

        <!-- ✅ Search Input -->
        <div class="search-box border-2 flex">
          <input
            type="search"
            v-model="searchQuery"
            placeholder="Search by Lesson Name or Location"
            class="p-2"
          />
          <button
            @click="clearSearch"
            class="bg-gray-500 text-white p-2 cursor-pointer"
          >
            Clear
          </button>
        </div>

        <div class="cart hidden" v-if="cart.length <= 0"></div>
        <div class="cart" v-else @click="showCart = true">
          Checkout ({{ cart.length }})
        </div>
      </header>

      <!-- ✅ Filters Section -->
      <div class="filters mt-24 flex justify-center gap-4">
        <select v-model="selectedLocation">
          <option value="">All Locations</option>
          <option
            v-for="location in uniqueLocations"
            :key="location"
            :value="location"
          >
            {{ location }}
          </option>
        </select>

        <select v-model="selectedRating">
          <option value="">All Ratings</option>
          <option
            v-for="rating in [5, 4, 3, 2, 1]"
            :key="rating"
            :value="rating"
          >
            {{ rating }} Stars & Up
          </option>
        </select>

        <select v-model="selectedPrice">
          <option value="">All Prices</option>
          <option value="low">Under 20 AED</option>
          <option value="mid">20 - 30 AED</option>
          <option value="high">30 AED & Above</option>
        </select>
      </div>

      <div class="pt-10">
        <p class="underline underline-offset-4 decoration-[8px] text-4xl px-9">
          Lessons
        </p>

        <div
          class="products-grid flex flex-wrap gap-4 items-center justify-center pt-4"
        >
          <!-- ✅ Show No Results Message -->
          <div v-if="filteredProducts.length === 0" class="no-results">
            <p class="text-xl font-semibold text-red-500">
              No lessons found. Try searching for another activity or location.
            </p>
          </div>

          <!-- ✅ Display Filtered Lessons -->
          <div
            v-for="product in filteredProducts"
            :key="product.id"
            class="product-item border-2 p-2"
          >
            <div class="card-section">
              <img
                class="object-cover w-64 h-64 mx-auto"
                v-bind:src="'images/' + product.LessonImage"
              />
              <h2 v-text="product.LessonName" class="text-2xl text-center"></h2>
            </div>
            <div class="reviews-container flex justify-center">
              <span v-for="n in product.Rating"
                ><i class="fa-solid fa-star"></i
              ></span>
              <span v-for="n in 5 - product.Rating"
                ><i class="fa-regular fa-star"></i
              ></span>
            </div>
            <p>
              <span class="font-bold">Location: </span>{{ product.Location }}
            </p>
            <p>
              <span class="font-bold">Available Items:</span> {{ product.Space
              }}
            </p>
            <p>
              <span class="font-bold"> Price: </span>
              {{ product.Price }} AED
            </p>

            <div class="card-section-2">
              <button
                class="addToCart border-2 p-2 hover:bg-black hover:text-white cursor-pointer"
                v-on:click="addToCart(product)"
                v-if="canAddToCart(product)"
              >
                Add to cart
              </button>
              <button class="addToCart border-2 p-2" disabled v-else>
                Add to cart
              </button>

              <span v-if="product.Space <= 0">Bookings Full</span>
              <span v-else-if="product.Space < 5"
                >Only {{ product.Space }} left!</span
              >
              <span v-else class="text-red-700">Buy Now!</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      new Vue({
        el: "#app",
        data: {
          cart: [],
          searchQuery: "",
          selectedLocation: "",
          selectedRating: "",
          selectedPrice: "",
          products: [
            {
              id: 1,
              LessonName: "Pottery",
              LessonImage: "Pottery.png",
              Rating: 4,
              Price: 20,
              Space: 10,
              Location: "Dubai",
            },
            {
              id: 2,
              LessonName: "Piano",
              LessonImage: "Piano.jpg",
              Rating: 5,
              Price: 30,
              Space: 5,
              Location: "Abu Dhabi",
            },
            {
              id: 3,
              LessonName: "Cricket",
              LessonImage: "Cricket.jpg",
              Rating: 3,
              Price: 25,
              Space: 8,
              Location: "Sharjah",
            },
            {
              id: 4,
              LessonName: "Swimming",
              LessonImage: "Swimming.jpg",
              Rating: 4,
              Price: 15,
              Space: 12,
              Location: "Ajman",
            },
            {
              id: 5,
              LessonName: "Coding",
              LessonImage: "Coding.jpg",
              Rating: 5,
              Price: 40,
              Space: 7,
              Location: "Fujairah",
            },
          ],
        },
        computed: {
          uniqueLocations() {
            return [
              ...new Set(this.products.map((product) => product.Location)),
            ];
          },
          filteredProducts() {
            return this.products.filter((product) => {
              const query = this.searchQuery.toLowerCase();
              const matchesSearch =
                product.LessonName.toLowerCase().includes(query) ||
                product.Location.toLowerCase().includes(query);
              const matchesLocation = this.selectedLocation
                ? product.Location === this.selectedLocation
                : true;
              const matchesRating = this.selectedRating
                ? product.Rating >= this.selectedRating
                : true;
              const matchesPrice = this.selectedPrice
                ? (this.selectedPrice === "low" && product.Price < 20) ||
                  (this.selectedPrice === "mid" &&
                    product.Price >= 20 &&
                    product.Price <= 30) ||
                  (this.selectedPrice === "high" && product.Price > 30)
                : true;
              return (
                matchesSearch &&
                matchesLocation &&
                matchesRating &&
                matchesPrice
              );
            });
          },
        },
        methods: {
          addToCart(product) {
            if (product.Space > 0) {
              product.Space--;
              this.cart.push(product);
            }
          },
          canAddToCart(product) {
            return product.Space > 0;
          },
          clearSearch() {
            this.searchQuery = "";
            this.selectedLocation = "";
            this.selectedRating = "";
            this.selectedPrice = "";
          },
        },
      });
    </script>
  </body>
</html>
